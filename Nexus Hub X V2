local Luna = loadstring(game:HttpGet("https://raw.githubusercontent.com/Nebula-Softworks/Luna-Interface-Suite/main/source.lua"))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer

local Window = Luna:CreateWindow({
	Name = "Nexus Hub",
	Subtitle = "v1.3.9",
	Size = UDim2.fromOffset(620, 460)
})

-- =======================
-- VARIABLES
-- =======================

local playerEnabled = true
local noclipEnabled = false
local infJumpEnabled = false
local infStaminaEnabled = false

local cframeSpeed = 1
local gravity = 196.2

local noclipConn
local jumpConn
local staminaConn

local storedCollisions = {}

-- =======================
-- PLAYER TAB
-- =======================

local PlayerTab = Window:CreateTab("Player", true)

local PlayerSection = PlayerTab:CreateSection("Movement")

PlayerSection:CreateSlider({
	Name = "CFrame Speed",
	Min = 1,
	Max = 170,
	Default = 1,
	Callback = function(v)
		cframeSpeed = v
	end
})

PlayerSection:CreateSlider({
	Name = "Gravity",
	Min = 0,
	Max = 300,
	Default = 196,
	Callback = function(v)
		gravity = v
	end
})

local PlayerSection2 = PlayerTab:CreateSection("Abilities")

PlayerSection2:CreateToggle({
	Name = "Infinite Jump",
	Default = false,
	Callback = function(v)
		infJumpEnabled = v

		if jumpConn then
			jumpConn:Disconnect()
			jumpConn = nil
		end

		if v then
			jumpConn = UserInputService.JumpRequest:Connect(function()
				local char = LocalPlayer.Character
				local hum = char and char:FindFirstChildOfClass("Humanoid")
				if hum then
					hum:ChangeState(Enum.HumanoidStateType.Jumping)
				end
			end)
		end
	end
})

PlayerSection2:CreateToggle({
	Name = "Noclip",
	Default = false,
	Callback = function(v)
		noclipEnabled = v

		if noclipConn then
			noclipConn:Disconnect()
			noclipConn = nil
		end

		local function restore()
			for part,state in pairs(storedCollisions) do
				if part and part.Parent then
					part.CanCollide = state
				end
			end
			storedCollisions = {}
		end

		if not v then
			restore()
			return
		end

		local char = LocalPlayer.Character
		if not char then return end

		for _,p in ipairs(char:GetDescendants()) do
			if p:IsA("BasePart") then
				storedCollisions[p] = p.CanCollide
				p.CanCollide = false
			end
		end

		noclipConn = RunService.Stepped:Connect(function()
			if not noclipEnabled then return end
			for part in pairs(storedCollisions) do
				if part and part.Parent then
					part.CanCollide = false
				end
			end
		end)
	end
})

-- =======================
-- FORSAKEN TAB
-- =======================

local ForsakenTab = Window:CreateTab("Forsaken ðŸ“‘")

local ForsakenSection = ForsakenTab:CreateSection("Game")

ForsakenSection:CreateToggle({
	Name = "Inf Stamina",
	Default = false,
	Callback = function(v)
		infStaminaEnabled = v

		if staminaConn then
			staminaConn:Disconnect()
			staminaConn = nil
		end

		if not v then return end

		pcall(function()
			local rs = cloneref(ReplicatedStorage)
			local sprint = rs.Systems.Character.Game.Sprinting
			local m = require(sprint)

			staminaConn = RunService.Heartbeat:Connect(function()
				if infStaminaEnabled then
					m.Stamina = 750
				end
			end)
		end)
	end
})

-- =======================
-- IN-GAME TAB
-- =======================

local InGameTab = Window:CreateTab("In-Game")

local InGameSection = InGameTab:CreateSection("Performance")

local storedFX = {}

InGameSection:CreateToggle({
	Name = "Performance Mode",
	Default = false,
	Callback = function(v)
		if v then
			storedFX = {}
			for _,obj in ipairs(workspace:GetDescendants()) do
				if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Beam") then
					storedFX[obj] = obj.Enabled
					obj.Enabled = false
				end
			end
			for _,fx in ipairs(Lighting:GetChildren()) do
				if fx:IsA("PostEffect") then
					storedFX[fx] = fx.Enabled
					fx.Enabled = false
				end
			end
		else
			for obj,state in pairs(storedFX) do
				if obj and obj.Parent then
					obj.Enabled = state
				end
			end
			storedFX = {}
		end
	end
})

-- =======================
-- INFORMATION TAB
-- =======================

local InfoTab = Window:CreateTab("Information ðŸ’¾")

local InfoSection1 = InfoTab:CreateSection("Clock")

local ClockLabel = InfoSection1:CreateLabel("00:00:00")

task.spawn(function()
	while task.wait(1) do
		ClockLabel:SetText(os.date("%H:%M:%S"))
	end
end)

local InfoSection2 = InfoTab:CreateSection("Creators")

InfoSection2:CreateLabel("Hydra")
InfoSection2:CreateLabel("Nexus Hub Team")

local InfoSection3 = InfoTab:CreateSection("Changelog")

InfoSection3:CreateLabel("v1.3.9")
InfoSection3:CreateLabel("Bug fixes")
InfoSection3:CreateLabel("UI resize")
InfoSection3:CreateLabel("Function rewrites")

-- =======================
-- MOVEMENT LOOP
-- =======================

RunService.Stepped:Connect(function()
	if not playerEnabled then return end

	local char = LocalPlayer.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	local hum = char and char:FindFirstChildOfClass("Humanoid")
	if not hrp or not hum then return end

	workspace.Gravity = gravity

	local dir = hum.MoveDirection
	if dir.Magnitude > 0 then
		hrp.CFrame = hrp.CFrame + (dir * (cframeSpeed * 0.06))
	end
end)
