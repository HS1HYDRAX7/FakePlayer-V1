local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")

local LocalPlayer = Players.LocalPlayer

local Window = Rayfield:CreateWindow({
	Name = "Nexus Hub v1.3.9 â˜„ï¸",
	LoadingTitle = "Nexus Hub",
	LoadingSubtitle = "",
	ConfigurationSaving = {
		Enabled = false
	},
	Theme = "Amethyst"
})

local playerEnabled = false
local noclipEnabled = false
local infJumpEnabled = false
local infStaminaEnabled = false

local cframeSpeed = 1
local gravity = 196.2

local noclipConn
local staminaConn
local storedCollisions = {}
local storedEffects = {}

-- PLAYER TAB
local PlayerTab = Window:CreateTab("Player", 110476445363181)

PlayerTab:CreateToggle({
	Name = "Enable Player",
	CurrentValue = false,
	Callback = function(v)
		playerEnabled = v
	end
})

PlayerTab:CreateSlider({
	Name = "CFrame Speed",
	Range = {1,170},
	Increment = 1,
	CurrentValue = 1,
	Callback = function(v)
		cframeSpeed = v
	end
})

PlayerTab:CreateSlider({
	Name = "Gravity",
	Range = {0,300},
	Increment = 1,
	CurrentValue = 196,
	Callback = function(v)
		gravity = v
	end
})

PlayerTab:CreateToggle({
	Name = "Noclip",
	CurrentValue = false,
	Callback = function(v)
		noclipEnabled = v

		if noclipConn then
			noclipConn:Disconnect()
			noclipConn = nil
		end

		local char = LocalPlayer.Character
		if not char then return end

		if v then
			storedCollisions = {}
			for _,p in ipairs(char:GetDescendants()) do
				if p:IsA("BasePart") then
					storedCollisions[p] = p.CanCollide
					p.CanCollide = false
				end
			end

			noclipConn = RunService.Stepped:Connect(function()
				if not noclipEnabled then return end
				for part in pairs(storedCollisions) do
					if part and part.Parent then
						part.CanCollide = false
					end
				end
			end)
		else
			for part,state in pairs(storedCollisions) do
				if part and part.Parent then
					part.CanCollide = state
				end
			end
			storedCollisions = {}
		end
	end
})

PlayerTab:CreateToggle({
	Name = "Inf Jump",
	CurrentValue = false,
	Callback = function(v)
		infJumpEnabled = v
	end
})

-- FORSAKEN TAB
local ForsakenTab = Window:CreateTab("Forsaken ðŸ“‘", 4483362458)

ForsakenTab:CreateToggle({
	Name = "Inf Stamina",
	CurrentValue = false,
	Callback = function(v)
		infStaminaEnabled = v

		if staminaConn then
			staminaConn:Disconnect()
			staminaConn = nil
		end

		if v then
			local rs = cloneref(game:GetService("ReplicatedStorage"))
			local sprint = rs.Systems.Character.Game.Sprinting
			local m = require(sprint)

			staminaConn = RunService.Heartbeat:Connect(function()
				if infStaminaEnabled then
					m.Stamina = 750
				end
			end)
		end
	end
})

-- IN-GAME TAB
local InGameTab = Window:CreateTab("In-game", 4483362458)

InGameTab:CreateToggle({
	Name = "Performance Mode",
	CurrentValue = false,
	Callback = function(v)
		if v then
			storedEffects = {}
			for _,obj in ipairs(workspace:GetDescendants()) do
				if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Beam") then
					storedEffects[obj] = obj.Enabled
					obj.Enabled = false
				end
			end
			for _,fx in ipairs(Lighting:GetChildren()) do
				if fx:IsA("PostEffect") then
					storedEffects[fx] = fx.Enabled
					fx.Enabled = false
				end
			end
		else
			for obj,state in pairs(storedEffects) do
				if obj and obj.Parent then
					obj.Enabled = state
				end
			end
			storedEffects = {}
		end
	end
})

-- INFORMATION TAB
local InfoTab = Window:CreateTab("Information ðŸ’¾", 4483362458)

local clockLabel = InfoTab:CreateLabel("00:00:00")

task.spawn(function()
	while task.wait(1) do
		clockLabel:SetText(os.date("%H:%M:%S"))
	end
end)

InfoTab:CreateLabel("Creators")
InfoTab:CreateLabel("Hydra / Nexus Hub Team")
InfoTab:CreateLabel("Changelog")
InfoTab:CreateLabel("v1.3.9")

-- INF JUMP
UserInputService.JumpRequest:Connect(function()
	if infJumpEnabled then
		local char = LocalPlayer.Character
		local hum = char and char:FindFirstChildOfClass("Humanoid")
		if hum then
			hum:ChangeState(Enum.HumanoidStateType.Jumping)
		end
	end
end)

-- MOVEMENT + GRAVITY
RunService.Stepped:Connect(function()
	if not playerEnabled then return end

	local char = LocalPlayer.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	local hum = char and char:FindFirstChildOfClass("Humanoid")

	if not hrp or not hum then return end

	workspace.Gravity = gravity

	local moveDir = hum.MoveDirection
	if moveDir.Magnitude > 0 then
		hrp.CFrame = hrp.CFrame + (moveDir * (cframeSpeed * 0.05))
	end
end)
