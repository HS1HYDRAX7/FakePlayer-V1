local Luna = loadstring(game:HttpGet(
	"https://raw.githubusercontent.com/Nebula-Softworks/Luna-Interface-Suite/main/source.lua"
))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local FONT = Font.new("rbxassetid://12187370928")

local Window = Luna:CreateWindow({
	Name = "Nexus Hub v2.0.6 â˜„ï¸",
	Subtitle = "by Hydra",
	LoadingEnabled = true,
	LoadingTitle = "Nexus Hub V2 â˜„ï¸",
	LoadingSubtitle = "Loading systems...",
	ConfigSettings = {
		RootFolder = nil,
		ConfigFolder = "NexusHub"
	}
})

local PlayerTab = Window:CreateTab({
	Name = "Player",
	Icon = "person",
	ImageSource = "Material",
	ShowTitle = true
})

local playerEnabled = false
local noclipEnabled = false
local infJump = false
local cframeSpeed = 1
local gravity = 196.2
local noclipConn
local originalCollisions = {}

local function applyNoclip(character)
	if noclipConn then noclipConn:Disconnect() end
	if not character then return end
	originalCollisions = {}
	for _, p in ipairs(character:GetDescendants()) do
		if p:IsA("BasePart") then
			originalCollisions[p] = p.CanCollide
			p.CanCollide = false
		end
	end
	noclipConn = RunService.Stepped:Connect(function()
		if not noclipEnabled then return end
		for _, p in ipairs(character:GetDescendants()) do
			if p:IsA("BasePart") then
				p.CanCollide = false
			end
		end
	end)
end

local function removeNoclip()
	if noclipConn then noclipConn:Disconnect() noclipConn = nil end
	for p, v in pairs(originalCollisions) do
		if p and p.Parent then
			p.CanCollide = v
		end
	end
	originalCollisions = {}
end

LocalPlayer.CharacterAdded:Connect(function(char)
	if noclipEnabled then
		task.wait(0.2)
		applyNoclip(char)
	end
end)

PlayerTab:CreateToggle({
	Name = "Enable",
	CurrentValue = false,
	Callback = function(v)
		playerEnabled = v
	end
})

PlayerTab:CreateSlider({
	Name = "CFrame Speed",
	Range = {1,70},
	Increment = 1,
	CurrentValue = 1,
	Callback = function(v)
		cframeSpeed = v
	end
})

PlayerTab:CreateSlider({
	Name = "Gravity",
	Range = {0,300},
	Increment = 1,
	CurrentValue = 196,
	Callback = function(v)
		gravity = v
	end
})

PlayerTab:CreateToggle({
	Name = "Noclip",
	CurrentValue = false,
	Callback = function(v)
		noclipEnabled = v
		if v then
			applyNoclip(LocalPlayer.Character)
		else
			removeNoclip()
		end
	end
})

PlayerTab:CreateToggle({
	Name = "Infinite Jump",
	CurrentValue = false,
	Callback = function(v)
		infJump = v
	end
})

UserInputService.JumpRequest:Connect(function()
	if infJump and LocalPlayer.Character then
		local hum = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
		if hum then
			hum:ChangeState(Enum.HumanoidStateType.Jumping)
		end
	end
end)

RunService.Heartbeat:Connect(function()
	if not playerEnabled then return end
	local char = LocalPlayer.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	local hum = char and char:FindFirstChildOfClass("Humanoid")
	if not hrp or not hum then return end
	workspace.Gravity = gravity
	local dir = hum.MoveDirection
	if dir.Magnitude > 0 then
		hrp.CFrame = hrp.CFrame + (dir * (cframeSpeed * 0.08))
	end
end)

local ForsakenTab = Window:CreateTab({
	Name = "Forsaken ðŸ“‘",
	Icon = "description",
	ImageSource = "Material",
	ShowTitle = true
})

local espSurvivor = false
local espKiller = false
local espGen = false
local autoGen = false
local genDelay = 5
local autoBusy = false
local infStamina = false
local staminaConn
local staminaModule

local function removeAllESP()
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr.Character then
			if plr.Character:FindFirstChild("NexusHL") then
				plr.Character.NexusHL:Destroy()
			end
			if plr.Character:FindFirstChild("NexusName") then
				plr.Character.NexusName:Destroy()
			end
		end
	end
	local map = workspace:FindFirstChild("Map")
	local ing = map and map:FindFirstChild("Ingame")
	local m = ing and ing:FindFirstChild("Map")
	if m then
		for _, g in ipairs(m:GetChildren()) do
			if g:FindFirstChild("NexusHL") then
				g.NexusHL:Destroy()
			end
			if g:FindFirstChild("NexusGen") then
				g.NexusGen:Destroy()
			end
		end
	end
end

local function addHighlight(inst, color)
	if inst:FindFirstChild("NexusHL") then return end
	local hl = Instance.new("Highlight")
	hl.Name = "NexusHL"
	hl.Adornee = inst
	hl.FillColor = color
	hl.OutlineColor = color
	hl.FillTransparency = 0.45
	hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
	hl.Parent = inst
end

local function addNameESP(char, text, color)
	if char:FindFirstChild("NexusName") then return end
	local hrp = char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end
	local bb = Instance.new("BillboardGui")
	bb.Name = "NexusName"
	bb.Adornee = hrp
	bb.Size = UDim2.fromOffset(120,18)
	bb.StudsOffset = Vector3.new(0,-3,0)
	bb.AlwaysOnTop = true
	bb.Parent = char
	local tl = Instance.new("TextLabel")
	tl.Size = UDim2.fromScale(1,1)
	tl.BackgroundTransparency = 1
	tl.Text = text
	tl.FontFace = FONT
	tl.TextSize = 12
	tl.TextColor3 = color
	tl.TextStrokeTransparency = 0.3
	tl.Parent = bb
end

local function updatePlayerESP()
	removeAllESP()
	local wp = workspace:FindFirstChild("Players")
	if not wp then return end
	local killers = wp:FindFirstChild("Killers")
	local survivors = wp:FindFirstChild("Survivors")
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= LocalPlayer and plr.Character then
			if espKiller and killers and plr.Character.Parent == killers then
				addHighlight(plr.Character, Color3.fromRGB(255,0,0))
				addNameESP(plr.Character, plr.Name, Color3.fromRGB(255,80,80))
			end
			if espSurvivor and survivors and plr.Character.Parent == survivors then
				addHighlight(plr.Character, Color3.fromRGB(0,255,0))
				addNameESP(plr.Character, plr.Name, Color3.fromRGB(80,255,80))
			end
		end
	end
end

local function addGenESP(gen)
	if gen:FindFirstChild("NexusGen") then return end
	addHighlight(gen, Color3.fromRGB(255,255,0))
	local bb = Instance.new("BillboardGui")
	bb.Name = "NexusGen"
	bb.Adornee = gen
	bb.Size = UDim2.fromOffset(80,18)
	bb.StudsOffset = Vector3.new(0,4,0)
	bb.AlwaysOnTop = true
	bb.Parent = gen
	local tl = Instance.new("TextLabel")
	tl.Size = UDim2.fromScale(1,1)
	tl.BackgroundTransparency = 1
	tl.FontFace = FONT
	tl.TextSize = 12
	tl.TextColor3 = Color3.fromRGB(255,255,0)
	tl.TextStrokeTransparency = 0.3
	tl.Parent = bb
	RunService.Heartbeat:Connect(function()
		if not gen or not gen.Parent then return end
		local p = gen:FindFirstChild("Progress")
		if p and p:IsA("NumberValue") then
			tl.Text = math.floor(p.Value) .. "%"
		else
			tl.Text = "GEN"
		end
	end)
end

local function updateGenESP()
	local map = workspace:FindFirstChild("Map")
	local ing = map and map:FindFirstChild("Ingame")
	local m = ing and ing:FindFirstChild("Map")
	if not m then return end
	for _, g in ipairs(m:GetChildren()) do
		if g.Name == "Generator" and espGen then
			addGenESP(g)
		end
	end
end

ForsakenTab:CreateToggle({
	Name = "ESP Survivors",
	CurrentValue = false,
	Callback = function(v)
		espSurvivor = v
		updatePlayerESP()
	end
})

ForsakenTab:CreateToggle({
	Name = "ESP Killers",
	CurrentValue = false,
	Callback = function(v)
		espKiller = v
		updatePlayerESP()
	end
})

ForsakenTab:CreateToggle({
	Name = "ESP Generators",
	CurrentValue = false,
	Callback = function(v)
		espGen = v
		removeAllESP()
		if v then updateGenESP() end
	end
})

ForsakenTab:CreateToggle({
	Name = "Auto Generator",
	CurrentValue = false,
	Callback = function(v)
		autoGen = v
	end
})

ForsakenTab:CreateSlider({
	Name = "Auto Gen Speed",
	Range = {1,10},
	Increment = 1,
	CurrentValue = 5,
	Callback = function(v)
		genDelay = v
	end
})

ForsakenTab:CreateToggle({
	Name = "Infinite Stamina",
	CurrentValue = false,
	Callback = function(v)
		infStamina = v
		if staminaConn then staminaConn:Disconnect() staminaConn = nil end
		if v then
			local sprint = ReplicatedStorage:WaitForChild("Systems")
				:WaitForChild("Character")
				:WaitForChild("Game")
				:WaitForChild("Sprinting")
			staminaModule = require(sprint)
			staminaConn = RunService.Heartbeat:Connect(function()
				if infStamina then
					staminaModule.Stamina = 999
				end
			end)
		end
	end
})

RunService.Heartbeat:Connect(function()
	if not autoGen or autoBusy then return end
	autoBusy = true
	local map = workspace:FindFirstChild("Map")
	local ing = map and map:FindFirstChild("Ingame")
	local m = ing and ing:FindFirstChild("Map")
	if m then
		for _, g in ipairs(m:GetChildren()) do
			if g.Name == "Generator" and g:FindFirstChild("Remotes") then
				pcall(function()
					g.Remotes.RE:FireServer()
				end)
				task.wait(genDelay)
			end
		end
	end
	autoBusy = false
end)

local OthersTab = Window:CreateTab({
	Name = "Others âœ¨",
	Icon = "sports_esports",
	ImageSource = "Material",
	ShowTitle = true
})

local stored = {}

OthersTab:CreateToggle({
	Name = "Performance Mode",
	CurrentValue = false,
	Callback = function(v)
		if v then
			stored = {}
			for _, o in ipairs(workspace:GetDescendants()) do
				if o:IsA("ParticleEmitter") or o:IsA("Trail") or o:IsA("Beam") then
					stored[o] = o.Enabled
					o.Enabled = false
				end
			end
			for _, fx in ipairs(Lighting:GetChildren()) do
				if fx:IsA("BloomEffect") or fx:IsA("BlurEffect")
				or fx:IsA("SunRaysEffect") or fx:IsA("ColorCorrectionEffect")
				or fx:IsA("DepthOfFieldEffect") then
					stored[fx] = fx.Enabled
					fx.Enabled = false
				end
			end
		else
			for o, s in pairs(stored) do
				if o and o.Parent then
					o.Enabled = s
				end
			end
			stored = {}
		end
	end
})

local InfoTab = Window:CreateTab({
	Name = "Information",
	Icon = "info",
	ImageSource = "Material",
	ShowTitle = true
})

local clock = InfoTab:CreateLabel({
	Text = "Clock: --:--:--",
	Style = 1
})

task.spawn(function()
	while task.wait(1) do
		clock:Set("Clock: " .. os.date("%H:%M:%S"))
	end
end)

InfoTab:CreateParagraph({
	Title = "Creators",
	Text = "Hydra"
})

InfoTab:CreateParagraph({
	Title = "Changelog",
	Text = "- ESP Highlight\n- Auto Generator\n- Stability"
})
