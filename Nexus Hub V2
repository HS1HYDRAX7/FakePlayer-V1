local Luna = loadstring(game:HttpGet(
    "https://raw.githubusercontent.com/Nebula-Softworks/Luna-Interface-Suite/main/source.lua"
))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

local Window = Luna:CreateWindow({
    Name = "Nexus Hub v2.0.6 â˜„ï¸",
    Subtitle = "by Hydra",
    LoadingEnabled = true,
    LoadingTitle = "Nexus Hub V2 â˜„ï¸",
    LoadingSubtitle = "Loading systems...",
    ConfigSettings = { RootFolder = nil, ConfigFolder = "NexusHub" }
})

--========================
-- PLAYER
--========================
local playerEnabled=false
local noclipEnabled=false
local infJump=false
local cframeSpeed=1
local gravity=196.2
local noclipConn
local originalCollisions={}

local function applyNoclip(char)
	if noclipConn then noclipConn:Disconnect() end
	if not char then return end
	originalCollisions={}
	for _,p in ipairs(char:GetDescendants()) do
		if p:IsA("BasePart") then
			originalCollisions[p]=p.CanCollide
			p.CanCollide=false
		end
	end
	noclipConn=RunService.Stepped:Connect(function()
		if not noclipEnabled then return end
		for _,p in ipairs(char:GetDescendants()) do
			if p:IsA("BasePart") then p.CanCollide=false end
		end
	end)
end

local function removeNoclip()
	if noclipConn then noclipConn:Disconnect() noclipConn=nil end
	for p,v in pairs(originalCollisions) do
		if p and p.Parent then p.CanCollide=v end
	end
	originalCollisions={}
end

LocalPlayer.CharacterAdded:Connect(function(c)
	if noclipEnabled then task.wait(0.2) applyNoclip(c) end
end)

local PlayerTab=Window:CreateTab({Name="Player",Icon="person",ImageSource="Material",ShowTitle=true})

PlayerTab:CreateToggle({Name="Enable",CurrentValue=false,Callback=function(v) playerEnabled=v end})
PlayerTab:CreateSlider({Name="CFrame Speed",Range={1,70},Increment=1,CurrentValue=1,Callback=function(v) cframeSpeed=v end})
PlayerTab:CreateSlider({Name="Gravity",Range={0,300},Increment=1,CurrentValue=196,Callback=function(v) gravity=v end})
PlayerTab:CreateToggle({
	Name="Noclip",
	CurrentValue=false,
	Callback=function(v)
		noclipEnabled=v
		if v then applyNoclip(LocalPlayer.Character) else removeNoclip() end
	end
})
PlayerTab:CreateToggle({Name="Infinite Jump",CurrentValue=false,Callback=function(v) infJump=v end})

UserInputService.JumpRequest:Connect(function()
	if infJump and LocalPlayer.Character then
		local h=LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
		if h then h:ChangeState(Enum.HumanoidStateType.Jumping) end
	end
end)

RunService.Heartbeat:Connect(function()
	if not playerEnabled then return end
	local c=LocalPlayer.Character
	local hrp=c and c:FindFirstChild("HumanoidRootPart")
	local h=c and c:FindFirstChildOfClass("Humanoid")
	if not hrp or not h then return end
	workspace.Gravity=gravity
	local d=h.MoveDirection
	if d.Magnitude>0 then
		hrp.CFrame=hrp.CFrame+(d*(cframeSpeed*0.08))
	end
end)

--========================
-- FORSAKEN
--========================
local ForsakenTab=Window:CreateTab({Name="Forsaken ðŸ“‘",Icon="description",ImageSource="Material",ShowTitle=true})

local espSurvivor=false
local espKiller=false
local espGen=false
local autoGen=false
local genDelay=5
local genBusy=false
local infStamina=false
local staminaConn
local staminaModule

local ESPFolder=Instance.new("Folder",workspace)
ESPFolder.Name="NexusESP_"..LocalPlayer.UserId

local function clearESP()
	for _,v in ipairs(ESPFolder:GetChildren()) do v:Destroy() end
end

local function createNameBillboard(model,name,color)
	local bb=Instance.new("BillboardGui")
	bb.Size=UDim2.fromScale(0,0)
	bb.StudsOffset=Vector3.new(0,-3,0)
	bb.AlwaysOnTop=true
	bb.Parent=model

	local txt=Instance.new("TextLabel",bb)
	txt.Size=UDim2.fromScale(1,1)
	txt.BackgroundTransparency=1
	txt.Text=name
	txt.TextColor3=color
	txt.TextSize=12
	txt.FontFace=Font.new("rbxassetid://12187370928")
	txt.TextStrokeTransparency=0.4
	return bb
end

local function addHighlight(model,color)
	if not model or model:FindFirstChild("NexusHL") then return end
	local h=Instance.new("Highlight")
	h.Name="NexusHL"
	h.Adornee=model
	h.FillColor=color
	h.OutlineColor=color
	h.FillTransparency=0.5
	h.DepthMode=Enum.HighlightDepthMode.AlwaysOnTop
	h.Parent=model
end

local function updatePlayerESP()
	clearESP()
	local wp=workspace:FindFirstChild("Players")
	if not wp then return end
	local killers=wp:FindFirstChild("Killers")
	local survivors=wp:FindFirstChild("Survivors")

	for _,pl in ipairs(Players:GetPlayers()) do
		if pl~=LocalPlayer and pl.Character then
			if espKiller and killers and pl.Character.Parent==killers then
				addHighlight(pl.Character,Color3.fromRGB(255,0,0))
				createNameBillboard(pl.Character,pl.Name,Color3.fromRGB(255,80,80))
			end
			if espSurvivor and survivors and pl.Character.Parent==survivors then
				addHighlight(pl.Character,Color3.fromRGB(0,255,0))
				createNameBillboard(pl.Character,pl.Name,Color3.fromRGB(80,255,80))
			end
		end
	end
end

local function updateGenESP()
	local map=workspace:FindFirstChild("Map")
	local ing=map and map:FindFirstChild("Ingame")
	local m=ing and ing:FindFirstChild("Map")
	if not m then return end

	for _,g in ipairs(m:GetChildren()) do
		if g.Name=="Generator" and espGen then
			addHighlight(g,Color3.fromRGB(255,255,0))
			if g:FindFirstChild("Progress") then
				local bb=Instance.new("BillboardGui",g)
				bb.Size=UDim2.fromScale(0,0)
				bb.StudsOffset=Vector3.new(0,3,0)
				bb.AlwaysOnTop=true

				local txt=Instance.new("TextLabel",bb)
				txt.Size=UDim2.fromScale(1,1)
				txt.BackgroundTransparency=1
				txt.TextSize=12
				txt.FontFace=Font.new("rbxassetid://12187370928")
				txt.TextColor3=Color3.fromRGB(255,255,0)

				RunService.Heartbeat:Connect(function()
					if g.Parent and g:FindFirstChild("Progress") then
						txt.Text=math.floor(g.Progress.Value).."%"
					end
				end)
			end
		end
	end
end

ForsakenTab:CreateToggle({Name="ESP Survivors",CurrentValue=false,Callback=function(v) espSurvivor=v updatePlayerESP() end})
ForsakenTab:CreateToggle({Name="ESP Killers",CurrentValue=false,Callback=function(v) espKiller=v updatePlayerESP() end})
ForsakenTab:CreateToggle({Name="ESP Generators",CurrentValue=false,Callback=function(v) espGen=v clearESP() updateGenESP() end})
ForsakenTab:CreateToggle({Name="Auto Generator",CurrentValue=false,Callback=function(v) autoGen=v end})
ForsakenTab:CreateSlider({Name="Auto Gen Speed",Range={1,10},Increment=1,CurrentValue=5,Callback=function(v) genDelay=v end})
ForsakenTab:CreateToggle({
	Name="Infinite Stamina",
	CurrentValue=false,
	Callback=function(v)
		infStamina=v
		if staminaConn then staminaConn:Disconnect() staminaConn=nil end
		if v then
			local rs=cloneref(game:GetService("ReplicatedStorage"))
			local sprint=rs:WaitForChild("Systems"):WaitForChild("Character"):WaitForChild("Game"):WaitForChild("Sprinting")
			staminaModule=require(sprint)
			staminaConn=RunService.Heartbeat:Connect(function()
				if infStamina then staminaModule.Stamina=999 end
			end)
		end
	end
})

RunService.Heartbeat:Connect(function()
	if not autoGen or genBusy then return end
	genBusy=true
	local map=workspace:FindFirstChild("Map")
	local ing=map and map:FindFirstChild("Ingame")
	local m=ing and ing:FindFirstChild("Map")
	if m then
		for _,g in ipairs(m:GetChildren()) do
			if g.Name=="Generator" and g:FindFirstChild("Remotes") then
				pcall(function() g.Remotes.RE:FireServer() end)
				task.wait(genDelay)
			end
		end
	end
	genBusy=false
end)

--========================
-- OTHERS
--========================
local OthersTab=Window:CreateTab({Name="Others âœ¨",Icon="sports_esports",ImageSource="Material",ShowTitle=true})
local stored={}

OthersTab:CreateToggle({
	Name="Performance Mode",
	CurrentValue=false,
	Callback=function(v)
		if v then
			stored={}
			for _,o in ipairs(workspace:GetDescendants()) do
				if o:IsA("ParticleEmitter") or o:IsA("Trail") or o:IsA("Beam") then
					stored[o]=o.Enabled
					o.Enabled=false
				end
			end
			for _,fx in ipairs(Lighting:GetChildren()) do
				if fx:IsA("BloomEffect") or fx:IsA("BlurEffect") or fx:IsA("SunRaysEffect")
				or fx:IsA("ColorCorrectionEffect") or fx:IsA("DepthOfFieldEffect") then
					stored[fx]=fx.Enabled
					fx.Enabled=false
				end
			end
		else
			for o,s in pairs(stored) do if o and o.Parent then o.Enabled=s end end
			stored={}
		end
	end
})

--========================
-- INFORMATION
--========================
local InfoTab=Window:CreateTab({Name="Information",Icon="info",ImageSource="Material",ShowTitle=true})
local clock=InfoTab:CreateLabel({Text="Clock: --:--:--",Style=1})
task.spawn(function()
	while task.wait(1) do clock:Set("Clock: "..os.date("%H:%M:%S")) end
end)
InfoTab:CreateParagraph({Title="Creators",Text="Hydra (Owner)\nLincoln"})
InfoTab:CreateParagraph({Title="Changelog",Text="- Highlight ESP\n- Name ESP\n- Generator %\n- Auto Gen Control\n- Stability"})
