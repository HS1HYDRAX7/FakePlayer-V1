local Luna = loadstring(game:HttpGet(
    "https://raw.githubusercontent.com/Nebula-Softworks/Luna-Interface-Suite/main/source.lua"
))()

local Window = Luna:CreateWindow({
    Name = "Nexus Hub v2.0.6 ☄️",
    Subtitle = "by Hydra",
    LoadingEnabled = true,
    LoadingTitle = "Nexus Hub V2 ☄️",
    LoadingSubtitle = "Loading systems...",
    ConfigSettings = {
        RootFolder = nil,
        ConfigFolder = "NexusHub"
    }
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

local playerEnabled = false
local noclipEnabled = false
local infJumpEnabled = false
local infStaminaEnabled = false

local cframeSpeed = 1
local gravity = 196.2

local espSurvivors = false
local espKillers = false
local espGenerators = false

local autoGenEnabled = false
local autoGenSpeed = 1

local highlights = {}
local labels = {}
local genLabels = {}

local FONT_ID = 12187370928

local function clearESP(tbl)
	for _, v in pairs(tbl) do
		if v then
			pcall(function()
				v:Destroy()
			end)
		end
	end
	table.clear(tbl)
end

local function createNameLabel(model, text)
	local bb = Instance.new("BillboardGui")
	bb.Size = UDim2.new(0, 100, 0, 20)
	bb.StudsOffset = Vector3.new(0, -3, 0)
	bb.AlwaysOnTop = true
	bb.Adornee = model:FindFirstChild("HumanoidRootPart")

	local tl = Instance.new("TextLabel", bb)
	tl.Size = UDim2.new(1, 0, 1, 0)
	tl.BackgroundTransparency = 1
	tl.Text = text
	tl.TextScaled = true
	tl.FontFace = Font.new("rbxassetid://" .. FONT_ID)
	tl.TextColor3 = Color3.new(1,1,1)

	bb.Parent = model
	return bb
end

local function addHighlight(model, color)
	local hl = Instance.new("Highlight")
	hl.FillColor = color
	hl.OutlineColor = color
	hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
	hl.Parent = model
	return hl
end

RunService.Heartbeat:Connect(function()
	if autoGenEnabled then
		for _, gen in ipairs(workspace:GetDescendants()) do
			if gen.Name == "Generator" and gen:FindFirstChild("Progress") then
				gen.Progress.Value = math.clamp(
					gen.Progress.Value + (autoGenSpeed * RunService.Heartbeat:Wait()),
					0,
					100
				)
			end
		end
	end
end)

local PlayerTab = Window:CreateTab({
	Name = "Player",
	Icon = "person",
	ImageSource = "Material",
	ShowTitle = true
})

PlayerTab:CreateToggle({
	Name = "Enable",
	CurrentValue = false,
	Callback = function(v)
		playerEnabled = v
	end
})

PlayerTab:CreateSlider({
	Name = "CFrame Speed",
	Range = {1,70},
	Increment = 1,
	CurrentValue = 1,
	Callback = function(v)
		cframeSpeed = v
	end
})

PlayerTab:CreateSlider({
	Name = "Gravity",
	Range = {0,300},
	Increment = 1,
	CurrentValue = 196,
	Callback = function(v)
		gravity = v
	end
})

PlayerTab:CreateToggle({
	Name = "Noclip",
	CurrentValue = false,
	Callback = function(v)
		noclipEnabled = v
	end
})

PlayerTab:CreateToggle({
	Name = "Infinite Jump",
	CurrentValue = false,
	Callback = function(v)
		infJumpEnabled = v
	end
})

local ForsakenTab = Window:CreateTab({
	Name = "Forsaken",
	Icon = "description",
	ImageSource = "Material",
	ShowTitle = true
})

ForsakenTab:CreateToggle({
	Name = "Infinite Stamina",
	CurrentValue = false,
	Callback = function(v)
		infStaminaEnabled = v
	end
})

ForsakenTab:CreateToggle({
	Name = "ESP Survivors",
	CurrentValue = false,
	Callback = function(v)
		espSurvivors = v
		clearESP(highlights)
		clearESP(labels)
	end
})

ForsakenTab:CreateToggle({
	Name = "ESP Killer",
	CurrentValue = false,
	Callback = function(v)
		espKillers = v
		clearESP(highlights)
		clearESP(labels)
	end
})

ForsakenTab:CreateToggle({
	Name = "ESP Generators",
	CurrentValue = false,
	Callback = function(v)
		espGenerators = v
		clearESP(genLabels)
	end
})

ForsakenTab:CreateToggle({
	Name = "Auto Generator",
	CurrentValue = false,
	Callback = function(v)
		autoGenEnabled = v
	end
})

ForsakenTab:CreateSlider({
	Name = "Auto Generator Speed",
	Range = {1,10},
	Increment = 1,
	CurrentValue = 1,
	Callback = function(v)
		autoGenSpeed = v
	end
})

local OthersTab = Window:CreateTab({
	Name = "Others ✨",
	Icon = "sports_esports",
	ImageSource = "Material",
	ShowTitle = true
})

OthersTab:CreateToggle({
	Name = "Performance Mode",
	CurrentValue = false,
	Callback = function(v)
		for _, obj in ipairs(workspace:GetDescendants()) do
			if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Beam") then
				obj.Enabled = not v
			end
		end
	end
})

local InfoTab = Window:CreateTab({
	Name = "Information",
	Icon = "info",
	ImageSource = "Material",
	ShowTitle = true
})

local clockLabel = InfoTab:CreateLabel({
	Text = "Clock: --:--:--",
	Style = 1
})

task.spawn(function()
	while task.wait(1) do
		clockLabel:Set("Clock: " .. os.date("%H:%M:%S"))
	end
end)

RunService.Heartbeat:Connect(function()
	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
			if espSurvivors and plr.Team and plr.Team.Name == "Survivors" then
				if not highlights[plr] then
					highlights[plr] = addHighlight(plr.Character, Color3.fromRGB(0,170,255))
					labels[plr] = createNameLabel(plr.Character, plr.Name)
				end
			elseif espKillers and plr.Team and plr.Team.Name == "Killer" then
				if not highlights[plr] then
					highlights[plr] = addHighlight(plr.Character, Color3.fromRGB(255,0,0))
					labels[plr] = createNameLabel(plr.Character, plr.Name)
				end
			end
		end
	end

	if espGenerators then
		for _, gen in ipairs(workspace:GetDescendants()) do
			if gen.Name == "Generator" and gen:FindFirstChild("Progress") then
				if not genLabels[gen] then
					local bb = Instance.new("BillboardGui")
					bb.Size = UDim2.new(0, 120, 0, 18)
					bb.AlwaysOnTop = true
					bb.Adornee = gen

					local tl = Instance.new("TextLabel", bb)
					tl.Size = UDim2.new(1,0,1,0)
					tl.BackgroundTransparency = 1
					tl.FontFace = Font.new("rbxassetid://" .. FONT_ID)
					tl.TextScaled = true

					bb.Parent = gen
					genLabels[gen] = {bb = bb, tl = tl}
				end

				local percent = math.clamp(math.floor(gen.Progress.Value),0,100)
				if percent >= 100 then
					genLabels[gen].tl.Text = "Generator repaired"
					genLabels[gen].tl.TextColor3 = Color3.fromRGB(0,120,0)
					genLabels[gen].tl.TextScaled = false
					if not gen:FindFirstChild("Highlight") then
						addHighlight(gen, Color3.fromRGB(0,120,0))
					end
				else
					genLabels[gen].tl.Text = percent .. "%"
					genLabels[gen].tl.TextColor3 = Color3.new(1,1,1)
				end
			end
		end
	end
end)
