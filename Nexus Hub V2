local Luna = loadstring(game:HttpGet(
    "https://raw.githubusercontent.com/Nebula-Softworks/Luna-Interface-Suite/main/source.lua"
))()

local Window = Luna:CreateWindow({
    Name = "Nexus Hub v2.0.6 ☄️",
    Subtitle = "by Hydra",
    LoadingEnabled = true,
    LoadingTitle = "Nexus Hub V2 ☄️",
    LoadingSubtitle = "Loading systems...",
    ConfigSettings = {
        RootFolder = nil,
        ConfigFolder = "NexusHub"
    }
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

local playerEnabled = false
local noclipEnabled = false
local infJumpEnabled = false
local infStaminaEnabled = false

local cframeSpeed = 1
local gravity = 196.2

local storedEffects = {}
local staminaConn
local staminaModule
local noclipConn
local originalCollisions = {}

local function applyNoclip(character)
	if noclipConn then
		noclipConn:Disconnect()
		noclipConn = nil
	end
	if not character then return end

	originalCollisions = {}
	for _, part in ipairs(character:GetDescendants()) do
		if part:IsA("BasePart") then
			originalCollisions[part] = part.CanCollide
			part.CanCollide = false
		end
	end

	noclipConn = RunService.Stepped:Connect(function()
		if not noclipEnabled then return end
		if not character or not character.Parent then return end
		for _, part in ipairs(character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end)
end

local function removeNoclip()
	if noclipConn then
		noclipConn:Disconnect()
		noclipConn = nil
	end
	for part, state in pairs(originalCollisions) do
		if part and part.Parent then
			part.CanCollide = state
		end
	end
	originalCollisions = {}
end

LocalPlayer.CharacterAdded:Connect(function(character)
	if noclipEnabled then
		task.wait(0.2)
		applyNoclip(character)
	end
end)

local PlayerTab = Window:CreateTab({
	Name = "Player",
	Icon = "person",
	ImageSource = "Material",
	ShowTitle = true
})

PlayerTab:CreateToggle({
	Name = "Enable Player",
	CurrentValue = false,
	Callback = function(v)
		playerEnabled = v
	end
})

PlayerTab:CreateSlider({
	Name = "CFrame Speed",
	Range = {1,170},
	Increment = 1,
	CurrentValue = 1,
	Callback = function(v)
		cframeSpeed = v
	end
})

PlayerTab:CreateSlider({
	Name = "Gravity",
	Range = {0,500},
	Increment = 1,
	CurrentValue = 196,
	Callback = function(v)
		gravity = v
		if playerEnabled then
			workspace.Gravity = v
		end
	end
})

PlayerTab:CreateToggle({
	Name = "Noclip",
	CurrentValue = false,
	Callback = function(v)
		noclipEnabled = v
		if v then
			applyNoclip(LocalPlayer.Character)
		else
			removeNoclip()
		end
	end
})

PlayerTab:CreateToggle({
	Name = "Infinite Jump",
	CurrentValue = false,
	Callback = function(v)
		infJumpEnabled = v
	end
})

local ForsakenTab = Window:CreateTab({
	Name = "Forsaken",
	Icon = "description",
	ImageSource = "Material",
	ShowTitle = true
})

ForsakenTab:CreateToggle({
	Name = "Infinite Stamina",
	CurrentValue = false,
	Callback = function(v)
		infStaminaEnabled = v
		if staminaConn then
			staminaConn:Disconnect()
			staminaConn = nil
		end
		if v then
			local rs = cloneref(game:GetService("ReplicatedStorage"))
			local sprintModule = rs:WaitForChild("Systems")
				:WaitForChild("Character")
				:WaitForChild("Game")
				:WaitForChild("Sprinting")
			staminaModule = require(sprintModule)
			staminaConn = RunService.Heartbeat:Connect(function()
				if infStaminaEnabled then
					staminaModule.Stamina = 750
				end
			end)
		end
	end
})

local InGameTab = Window:CreateTab({
	Name = "In-game",
	Icon = "sports_esports",
	ImageSource = "Material",
	ShowTitle = true
})

InGameTab:CreateToggle({
	Name = "Performance Mode",
	CurrentValue = false,
	Callback = function(v)
		if v then
			storedEffects = {}
			for _, obj in ipairs(workspace:GetDescendants()) do
				if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Beam") then
					storedEffects[obj] = obj.Enabled
					obj.Enabled = false
				end
			end
			for _, fx in ipairs(Lighting:GetChildren()) do
				if fx:IsA("BloomEffect") or fx:IsA("BlurEffect")
				or fx:IsA("SunRaysEffect") or fx:IsA("ColorCorrectionEffect")
				or fx:IsA("DepthOfFieldEffect") then
					storedEffects[fx] = fx.Enabled
					fx.Enabled = false
				end
			end
		else
			for obj, state in pairs(storedEffects) do
				if obj and obj.Parent then
					obj.Enabled = state
				end
			end
			storedEffects = {}
		end
	end
})

local InfoTab = Window:CreateTab({
	Name = "Information",
	Icon = "info",
	ImageSource = "Material",
	ShowTitle = true
})

local clockLabel = InfoTab:CreateLabel({
	Text = "Clock: --:--:--",
	Style = 1
})

task.spawn(function()
	while task.wait(1) do
		clockLabel:Set("Clock: " .. os.date("%H:%M:%S"))
	end
end)

InfoTab:CreateParagraph({
	Title = "Creators",
	Text = "Hydra\nNexus Hub Team"
})

InfoTab:CreateParagraph({
	Title = "Changelog",
	Text = "- Stability\n- Forsaken Support\n- Noclip Respawn Fix"
})

UserInputService.JumpRequest:Connect(function()
	if infJumpEnabled and LocalPlayer.Character then
		local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
		if humanoid then
			humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
		end
	end
end)

RunService.Heartbeat:Connect(function()
	if not playerEnabled then return end
	local character = LocalPlayer.Character
	local hrp = character and character:FindFirstChild("HumanoidRootPart")
	local humanoid = character and character:FindFirstChildOfClass("Humanoid")
	if not hrp or not humanoid then return end
	workspace.Gravity = gravity
	local dir = humanoid.MoveDirection
	if dir.Magnitude > 0 then
		hrp.CFrame = hrp.CFrame + (dir * (cframeSpeed * 0.08))
	end
end)
