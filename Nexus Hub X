local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
    Name = "Nexus Hub v1.2.7 â˜„ï¸",
    KeySystem = true,
    KeySettings = {
        FileName = "HydraKey",
        SaveKey = false,
        Key = "NHX"
    },
    Theme = "Amethyst"
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

local playerEnabled = false
local noclipEnabled = false
local infJumpEnabled = false
local infStaminaEnabled = false

local cframeSpeed = 1
local gravity = 196.2

local storedEffects = {}
local staminaConn, staminaModule, noclipConn
local spawnedBlocks = {}
local MAX_BLOCKS = 10

-- PLAYER
local PlayerTab = Window:CreateTab("Player", 110476445363181)

PlayerTab:CreateToggle({Name="Enable Player",CurrentValue=false,Callback=function(v)playerEnabled=v end})
PlayerTab:CreateSlider({Name="CFrame Speed",Range={1,170},Increment=1,CurrentValue=1,Callback=function(v)cframeSpeed=v end})
PlayerTab:CreateSlider({
    Name="Gravity",
    Range={0,500},
    Increment=1,
    CurrentValue=196,
    Callback=function(v)
        gravity=v
        if playerEnabled then workspace.Gravity=v end
    end
})

PlayerTab:CreateToggle({
    Name="Noclip (Bypass)",
    CurrentValue=false,
    Callback=function(v)
        noclipEnabled=v
        if noclipConn then noclipConn:Disconnect() noclipConn=nil end
        if v then
            noclipConn=RunService.Stepped:Connect(function()
                local c=LocalPlayer.Character
                if c then
                    for _,p in ipairs(c:GetDescendants()) do
                        if p:IsA("BasePart") then p.CanCollide=false end
                    end
                end
            end)
        end
    end
})

PlayerTab:CreateToggle({Name="InfJump",CurrentValue=false,Callback=function(v)infJumpEnabled=v end})

-- FORSAKEN
local ForsakenTab = Window:CreateTab("Forsaken ðŸ“‘", 4483362458)

ForsakenTab:CreateToggle({
    Name="Inf Stamina",
    CurrentValue=false,
    Callback=function(v)
        infStaminaEnabled=v
        if staminaConn then staminaConn:Disconnect() staminaConn=nil end
        if v then
            pcall(function()
                local rs=cloneref(game:GetService("ReplicatedStorage"))
                staminaModule=require(rs.Systems.Character.Game.Sprinting)
                staminaConn=RunService.Heartbeat:Connect(function()
                    if infStaminaEnabled and staminaModule then
                        staminaModule.Stamina=750
                    end
                end)
            end)
        end
    end
})

-- IN-GAME
local InGameTab = Window:CreateTab("In-game", 4483362458)

InGameTab:CreateToggle({
    Name="Performance Mode",
    CurrentValue=false,
    Callback=function(v)
        pcall(function()
            if v then
                storedEffects={}
                for _,o in ipairs(workspace:GetDescendants()) do
                    if o:IsA("ParticleEmitter") or o:IsA("Trail") or o:IsA("Beam") then
                        storedEffects[o]=o.Enabled
                        o.Enabled=false
                    end
                end
                for _,fx in ipairs(Lighting:GetChildren()) do
                    if fx:IsA("BloomEffect") or fx:IsA("BlurEffect")
                    or fx:IsA("SunRaysEffect") or fx:IsA("ColorCorrectionEffect")
                    or fx:IsA("DepthOfFieldEffect") then
                        storedEffects[fx]=fx.Enabled
                        fx.Enabled=false
                    end
                end
            else
                for o,s in pairs(storedEffects) do
                    if o and o.Parent then o.Enabled=s end
                end
                storedEffects={}
            end
        end)
    end
})

InGameTab:CreateButton({
    Name="Spawn Ball",
    Callback=function()
        if #spawnedBlocks>=MAX_BLOCKS then return end
        local char=LocalPlayer.Character
        local hrp=char and char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local ball=Instance.new("Part")
        ball.Shape=Enum.PartType.Ball
        ball.Size=Vector3.new(6,6,6)
        ball.Color=Color3.fromRGB(120,190,255)
        ball.Transparency=0.5
        ball.Material=Enum.Material.SmoothPlastic
        ball.Anchored=false
        ball.CanCollide=true
        ball.Massless=false
        ball.CustomPhysicalProperties=PhysicalProperties.new(
            0.3,   -- density (leve)
            0.2,   -- friction
            0.5,   -- elasticity
            1,     -- friction weight
            1      -- elasticity weight
        )
        ball.CFrame=hrp.CFrame*CFrame.new(0,0,-10)
        ball.Parent=workspace

        local drag=Instance.new("DragDetector")
        drag.Parent=ball

        table.insert(spawnedBlocks,ball)
    end
})

InGameTab:CreateButton({
    Name="Delete Blocks",
    Callback=function()
        for _,b in ipairs(spawnedBlocks) do
            if b and b.Parent then b:Destroy() end
        end
        table.clear(spawnedBlocks)
    end
})

-- CREDITS
local CreditsTab = Window:CreateTab("Credits ðŸ’»", 4483362458)
CreditsTab:CreateParagraph({Title="Version",Content="v1.2.7"})
CreditsTab:CreateParagraph({Title="Creators",Content="Hydra\nNexus Hub Team"})
CreditsTab:CreateParagraph({Title="Changelog",Content="- Physics ball\n- Pushable & light\n- Stability fixes"})

-- RUNTIME
UserInputService.JumpRequest:Connect(function()
    if infJumpEnabled and LocalPlayer.Character then
        local h=LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if h then h:ChangeState(Enum.HumanoidStateType.Jumping) end
    end
end)

RunService.Heartbeat:Connect(function()
    if not playerEnabled then return end
    local c=LocalPlayer.Character
    local hrp=c and c:FindFirstChild("HumanoidRootPart")
    local h=c and c:FindFirstChildOfClass("Humanoid")
    if not hrp or not h then return end
    workspace.Gravity=gravity
    local d=h.MoveDirection
    if d.Magnitude>0 then
        hrp.CFrame=hrp.CFrame+(d*(cframeSpeed*0.08))
    end
end)
